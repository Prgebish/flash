*emacs-flash.txt*                                             emacs-flash docs

==============================================================================
Table of Contents                           *emacs-flash-table-of-contents*

1. emacs-flash                                      |emacs-flash-introduction|
  - Features                                              |emacs-flash-features|
  - Requirements                                      |emacs-flash-requirements|
  - Installation                                      |emacs-flash-installation|
  - Configuration                                    |emacs-flash-configuration|
  - Usage                                                    |emacs-flash-usage|
  - Commands                                              |emacs-flash-commands|
  - Faces                                                    |emacs-flash-faces|
  - Examples                                              |emacs-flash-examples|
  - Troubleshooting                                |emacs-flash-troubleshooting|
  - Alternatives                                      |emacs-flash-alternatives|
  - Credits                                                |emacs-flash-credits|

==============================================================================
1. emacs-flash                                      *emacs-flash-introduction*

`emacs-flash` lets you navigate your code with search labels, enhanced
character motions, and Treesitter integration.

Inspired by flash.nvim <https://github.com/folke/flash.nvim> for Neovim.

FEATURES                                              *emacs-flash-features*

- *Search Integration*: integrate emacs-flash with your regular search using
  `/` or `C-s`. Labels appear next to the matches, allowing you to quickly
  jump to any location. Labels are guaranteed not to exist as a continuation
  of the search pattern.

- *Type as many characters as you want* before using a jump label.

- *Enhanced f, t, F, T motions* with optional jump labels.

- *Treesitter Integration*: all parents of the Treesitter node under your
  cursor are highlighted with a label for quick selection of a specific
  Treesitter node.

- *Jump Mode*: a standalone jumping mode similar to search.

- *Multi Window* jumping.

- *Evil integration*: works seamlessly with evil-mode.

REQUIREMENTS                                      *emacs-flash-requirements*

- Emacs >= *27.1*
- Emacs >= *29.1* for Treesitter support
- Optional: evil-mode <https://github.com/emacs-evil/evil> for Vim-style
  keybindings

INSTALLATION                                      *emacs-flash-installation*

use-package (from local path) ~

>elisp
    (use-package emacs-flash
      :load-path "~/path/to/emacs-flash"
      :commands (emacs-flash-jump emacs-flash-evil-jump
                 emacs-flash-treesitter emacs-flash-treesitter-evil)
      :bind ("s-j" . emacs-flash-jump)
      :custom
      (emacs-flash-multi-window t)
      :init
      ;; Evil integration
      (with-eval-after-load 'evil
        (require 'emacs-flash-evil)
        (evil-global-set-key 'normal (kbd "s") #'emacs-flash-evil-jump)
        ;; Char motions (f/t/F/T)
        (emacs-flash-char-setup-evil-keys))
      :config
      ;; Search integration (flash labels during / and ?)
      (require 'emacs-flash-isearch)
      (emacs-flash-isearch-mode 1))
<

straight.el ~

>elisp
    (straight-use-package
     '(emacs-flash :type git :host github :repo "chestnykh/emacs-flash"))
<

Manual ~

Clone the repository and add to your load-path:

>elisp
    (add-to-list 'load-path "~/path/to/emacs-flash")
    (require 'emacs-flash)
<

CONFIGURATION                                    *emacs-flash-configuration*

emacs-flash is highly configurable. All options are customizable via
`M-x customize-group RET emacs-flash RET`.

Basic Options ~
                                                  *emacs-flash-config-basic*

`emacs-flash-labels`                                    *emacs-flash-labels*
    Default: "asdfjkl;ghqwertyuiopzxcvbnm"
    Characters to use as jump labels, ordered by priority.
    Earlier characters are assigned to closer matches.

`emacs-flash-label-uppercase`                  *emacs-flash-label-uppercase*
    Default: nil
    When non-nil, also use uppercase versions of labels.
    This doubles the number of available single-character labels.
    Lowercase labels are assigned to closer matches, uppercase to farther.
    Uppercase labels never conflict with search continuation.

`emacs-flash-multi-char-labels`                *emacs-flash-multi-char-labels*
    Default: nil
    When non-nil, use multi-character labels (aa, as, ad...) when matches
    exceed available single-char labels. When nil, only single-character
    labels are used and excess matches are unlabeled.

`emacs-flash-multi-window`                        *emacs-flash-multi-window*
    Default: t
    When non-nil, search in all visible windows.

`emacs-flash-autojump`                                *emacs-flash-autojump*
    Default: nil
    When non-nil, automatically jump when there is only one match.
    Disabled by default to prevent accidental text modification.

`emacs-flash-backdrop`                                *emacs-flash-backdrop*
    Default: t
    When non-nil, dim non-matching text with backdrop effect.

`emacs-flash-case-fold`                              *emacs-flash-case-fold*
    Default: t
    When non-nil, ignore case when searching.

`emacs-flash-rainbow`                                  *emacs-flash-rainbow*
    Default: nil
    When non-nil, use different colors for each label.
    Makes labels more visually distinct.

`emacs-flash-highlight-matches`              *emacs-flash-highlight-matches*
    Default: t
    When non-nil, highlight matched text.
    When nil, only labels are shown, keeping original syntax highlighting.

`emacs-flash-label-position`                    *emacs-flash-label-position*
    Default: 'after
    Where to display the jump label relative to the match.
    - `after': Label appears after the match (default, like flash.nvim)
    - `before': Label appears before the match
    - `overlay': Label overlays the first character of match
    - `eol': Labels at end of line (for line-based jumps)

`emacs-flash-jump-position`                      *emacs-flash-jump-position*
    Default: 'start
    Where to place cursor after jumping to a match.
    - `start': Cursor at the beginning of the match (default)
    - `end': Cursor at the end of the match

`emacs-flash-jumplist`                                *emacs-flash-jumplist*
    Default: t
    When non-nil, save position to mark ring before jumping.
    This allows returning to the previous position with `C-u C-SPC`
    or `C-x C-SPC` (global mark), or with evil's `C-o`.

`emacs-flash-search-history`                    *emacs-flash-search-history*
    Default: nil
    When non-nil, add search pattern to Emacs search history.
    The pattern will appear in isearch history (M-p/M-n).

`emacs-flash-nohlsearch`                            *emacs-flash-nohlsearch*
    Default: nil
    When non-nil, clear search highlighting after jump.
    Works with both isearch and evil-search highlighting.

`emacs-flash-min-pattern-length`            *emacs-flash-min-pattern-length*
    Default: 0
    Minimum pattern length to show jump labels.
    Labels won't appear until the pattern reaches this length.
    Set to 0 to always show labels (default).

Char Motion Options ~
                                                   *emacs-flash-config-char*

`emacs-flash-char-jump-labels`                *emacs-flash-char-jump-labels*
    Default: nil
    When non-nil, show labels for multiple character matches.
    When nil, just highlight matches and jump to first one.

`emacs-flash-char-multi-line`                  *emacs-flash-char-multi-line*
    Default: nil
    When non-nil, search beyond current line.
    When nil, only search on current line (like standard Vim behavior).

`emacs-flash-char-reserved-labels`        *emacs-flash-char-reserved-labels*
    Default: ""
    Characters that should NOT be used as labels in char motions.
    These are typically evil/vim editing commands that users want to
    execute immediately after f/t/F/T without interference from labels.
    Example: "aisoAIS"

Search Integration Options ~
                                                *emacs-flash-config-isearch*

`emacs-flash-isearch-enabled`                  *emacs-flash-isearch-enabled*
    Default: t
    When non-nil, show flash labels during search by default.

`emacs-flash-isearch-toggle-key`            *emacs-flash-isearch-toggle-key*
    Default: "C-;"
    Key to toggle flash labels during search.
    Set to nil to disable toggle functionality.

`emacs-flash-isearch-trigger`                  *emacs-flash-isearch-trigger*
    Default: nil
    Character that activates label jumping during search.
    When nil, labels work directly - smart skip prevents conflicts
    by not assigning labels that would continue the search pattern.
    When set (e.g. ";"), you must type trigger + label to jump.

Treesitter Options ~
                                             *emacs-flash-config-treesitter*

`emacs-flash-treesitter-max-depth`        *emacs-flash-treesitter-max-depth*
    Default: 10
    Maximum depth of parent nodes to show.

Example Configuration ~
                                                *emacs-flash-config-example*

>elisp
    (use-package emacs-flash
      :custom
      (emacs-flash-labels "asdfjkl;ghqwertyuiopzxcvbnm")
      (emacs-flash-label-uppercase t)  ; double available labels (a-z + A-Z)
      (emacs-flash-multi-window t)
      (emacs-flash-autojump t)         ; optional: auto-jump on single match
      (emacs-flash-backdrop nil)
      (emacs-flash-rainbow t)
      (emacs-flash-highlight-matches t)
      (emacs-flash-label-position 'after)
      (emacs-flash-char-jump-labels t)
      (emacs-flash-nohlsearch t))
<

USAGE                                                    *emacs-flash-usage*

Standalone Jump ~
                                                   *emacs-flash-usage-jump*

>elisp
    M-x emacs-flash-jump
<

Or with evil: press `s` (if configured).

Type characters to narrow matches, then press a label to jump.

Special keys during jump:
- `ESC`: Cancel jump
- `RET`: Jump to first match
- `Backspace`: Delete last character from pattern

Search Integration ~
                                                 *emacs-flash-usage-search*

With `emacs-flash-isearch-mode` enabled:
- Use `/` or `?` (evil) or `C-s` (isearch)
- Labels appear on matches
- Press label to jump directly
- `C-;` to toggle labels on/off

Character Motions (f/t/F/T) ~
                                                   *emacs-flash-usage-char*

After `emacs-flash-char-setup-evil-keys`:
- `f{char}` - jump to char forward
- `t{char}` - jump to before char forward
- `F{char}` - jump to char backward
- `T{char}` - jump to after char backward
- `;` - repeat motion
- `,` - repeat motion reverse

With `emacs-flash-char-jump-labels` enabled, labels appear on multiple
matches.

Treesitter ~
                                             *emacs-flash-usage-treesitter*

>elisp
    M-x emacs-flash-treesitter       ; select node with labels
    M-x emacs-flash-treesitter-evil  ; same with evil visual mode
<

Shows labels for nested syntax nodes at point. Press label to select
entire node.

This is useful for quickly selecting:
- Function definitions
- Class definitions
- Code blocks
- Any other Treesitter-recognized syntax structures

COMMANDS                                              *emacs-flash-commands*

Interactive Commands ~

`emacs-flash-jump`                                        *emacs-flash-jump*
    Start flash jump session.
    Type characters to search, then press a label to jump.

`emacs-flash-jump-continue`                      *emacs-flash-jump-continue*
    Continue flash jump with the last search pattern.
    If no previous pattern exists, starts a new search.

`emacs-flash-evil-jump`                              *emacs-flash-evil-jump*
    Flash jump as evil motion.
    Works with operators: `d s <target>` deletes to target.
    In visual mode: extends selection to target.

`emacs-flash-evil-setup`                            *emacs-flash-evil-setup*
    Set up evil keybindings for emacs-flash.
    Binds `gs` in normal, visual, motion, and operator states.
    Optional argument CHAR-MOTIONS (non-nil) also sets up f/t/F/T.

`emacs-flash-char-setup-evil-keys`        *emacs-flash-char-setup-evil-keys*
    Setup evil keybindings for flash char motions.
    Replaces standard f/t/F/T with emacs-flash versions.

`emacs-flash-char-find`                              *emacs-flash-char-find*
    Jump forward to CHAR on current line.
    Enhanced `f` motion with optional labels.

`emacs-flash-char-find-to`                        *emacs-flash-char-find-to*
    Jump forward to before CHAR on current line.
    Enhanced `t` motion with optional labels.

`emacs-flash-char-find-backward`            *emacs-flash-char-find-backward*
    Jump backward to CHAR on current line.
    Enhanced `F` motion with optional labels.

`emacs-flash-char-find-to-backward`      *emacs-flash-char-find-to-backward*
    Jump backward to after CHAR on current line.
    Enhanced `T` motion with optional labels.

`emacs-flash-char-repeat`                          *emacs-flash-char-repeat*
    Repeat last char motion in same direction.
    Bound to `;` after setup.

`emacs-flash-char-repeat-reverse`          *emacs-flash-char-repeat-reverse*
    Repeat last char motion in opposite direction.
    Bound to `,` after setup.

`emacs-flash-isearch-mode`                        *emacs-flash-isearch-mode*
    Show flash labels during incremental search.
    Works with both evil-ex-search and isearch.

`emacs-flash-treesitter`                            *emacs-flash-treesitter*
    Show labels for treesitter nodes at point.
    Press a label to select that node's range.

`emacs-flash-treesitter-evil`                  *emacs-flash-treesitter-evil*
    Treesitter node selection with evil visual mode.

FACES                                                    *emacs-flash-faces*

Core Faces ~

`emacs-flash-label`                                    *emacs-flash-label-face*
    Face for jump labels.
    Default: blue background (#3b82f6) with white text on light themes,
    pink background (#fecdd3) with dark red text (#881337) on dark themes.

`emacs-flash-match`                                    *emacs-flash-match-face*
    Face for search matches.
    Default: underline.

`emacs-flash-backdrop`                              *emacs-flash-backdrop-face*
    Face for backdrop effect.
    Default: inherits from `shadow`.

Rainbow Faces ~
                                             *emacs-flash-rainbow-faces*

When `emacs-flash-rainbow` is non-nil, labels cycle through these colors:

`emacs-flash-label-red`       - Red (Tailwind red-200/900)
`emacs-flash-label-amber`     - Amber (Tailwind amber-200/900)
`emacs-flash-label-lime`      - Lime (Tailwind lime-200/900)
`emacs-flash-label-green`     - Green (Tailwind green-200/900)
`emacs-flash-label-teal`      - Teal (Tailwind teal-200/900)
`emacs-flash-label-cyan`      - Cyan (Tailwind cyan-200/900)
`emacs-flash-label-blue`      - Blue (Tailwind blue-200/900)
`emacs-flash-label-violet`    - Violet (Tailwind violet-200/900)
`emacs-flash-label-fuchsia`   - Fuchsia (Tailwind fuchsia-200/900)
`emacs-flash-label-rose`      - Rose (Tailwind rose-200/900)

Customizing Faces ~
                                             *emacs-flash-customizing-faces*

>elisp
    ;; Change label appearance
    (set-face-attribute 'emacs-flash-label nil
                        :background "#ff0000"
                        :foreground "#ffffff"
                        :weight 'bold)

    ;; Change match highlight
    (set-face-attribute 'emacs-flash-match nil
                        :underline nil
                        :background "#ffff00"
                        :foreground "#000000")

    ;; Disable backdrop (already covered by variable, but can also
    ;; be done via face)
    (set-face-attribute 'emacs-flash-backdrop nil
                        :foreground nil)
<

EXAMPLES                                              *emacs-flash-examples*

Forward search only ~

>elisp
    ;; Create a command that only searches forward
    (defun my-flash-forward ()
      "Flash jump forward only."
      (interactive)
      (let ((emacs-flash-multi-window nil))
        (save-restriction
          (narrow-to-region (point) (window-end))
          (emacs-flash-jump))))
<

Backward search only ~

>elisp
    ;; Create a command that only searches backward
    (defun my-flash-backward ()
      "Flash jump backward only."
      (interactive)
      (let ((emacs-flash-multi-window nil))
        (save-restriction
          (narrow-to-region (window-start) (point))
          (emacs-flash-jump))))
<

Custom label characters ~

>elisp
    ;; Use home row keys only
    (setq emacs-flash-labels "asdfjkl;")

    ;; Use numbers
    (setq emacs-flash-labels "1234567890")
<

Custom keybindings for char motions ~

Instead of using `emacs-flash-char-setup-evil-keys`, you can bind
the functions manually to any keys:

>elisp
    ;; Available functions:
    ;; - emacs-flash-char-find           (replaces f)
    ;; - emacs-flash-char-find-to        (replaces t)
    ;; - emacs-flash-char-find-backward  (replaces F)
    ;; - emacs-flash-char-find-to-backward (replaces T)
    ;; - emacs-flash-char-repeat         (replaces ;)
    ;; - emacs-flash-char-repeat-reverse (replaces ,)

    ;; Example: use different keys
    (with-eval-after-load 'evil
      (define-key evil-motion-state-map "s" #'emacs-flash-char-find)
      (define-key evil-motion-state-map "S" #'emacs-flash-char-find-backward))

    ;; Example: vanilla Emacs (no evil)
    (global-set-key (kbd "M-f") #'emacs-flash-char-find)
    (global-set-key (kbd "M-F") #'emacs-flash-char-find-backward)
<

Different settings for different modes ~

>elisp
    ;; Disable multi-window in certain modes
    (add-hook 'org-mode-hook
              (lambda ()
                (setq-local emacs-flash-multi-window nil)))

    ;; Enable rainbow in programming modes
    (add-hook 'prog-mode-hook
              (lambda ()
                (setq-local emacs-flash-rainbow t)))
<

Integration with which-key ~

>elisp
    (with-eval-after-load 'which-key
      (which-key-add-key-based-replacements
        "g s" "flash-jump"))
<

Jump to line ~

>elisp
    (defun my-flash-line ()
      "Flash jump to beginning of any visible line."
      (interactive)
      (let ((emacs-flash-label-position 'eol))
        ;; Use a pattern that matches line beginnings
        ;; This is a simplified example
        (emacs-flash-jump)))
<

TROUBLESHOOTING                                *emacs-flash-troubleshooting*

Labels don't appear during search ~

1. Make sure `emacs-flash-isearch-mode` is enabled:
   `M-x emacs-flash-isearch-mode RET`

2. Check if labels are toggled off - press `C-;` to toggle.

3. Verify `emacs-flash-isearch-enabled` is t.

f/t/F/T motions don't work ~

1. Make sure you called `(emacs-flash-char-setup-evil-keys)` after
   loading evil-mode.

2. Check if evil-mode is active in current buffer.

Treesitter commands error ~

1. Treesitter requires Emacs 29.1 or later.

2. Current buffer must have a treesitter parser. Check with:
   `(treesit-parser-list)`

3. You need to have the appropriate language grammar installed.

Labels overlap or look wrong ~

1. Try different `emacs-flash-label-position` values.

2. Adjust face attributes if colors clash with your theme.

3. Disable `emacs-flash-highlight-matches` if too noisy.

Performance issues with many matches ~

1. Set `emacs-flash-min-pattern-length` to 1 or 2 to require more
   characters before showing labels.

2. Disable `emacs-flash-multi-window` to search only current window.

3. Disable `emacs-flash-multi-char-labels` to limit to 26 labels max.

ALTERNATIVES                                      *emacs-flash-alternatives*

- avy <https://github.com/abo-abo/avy>
  Jump to visible text using a char-based decision tree.
  More mature, different approach (decision tree vs search+label).

- ace-jump-mode <https://github.com/winterTTr/ace-jump-mode>
  Quick cursor movement.
  Older package, less actively maintained.

Key differences from avy:
- emacs-flash uses incremental search (type any number of chars)
- avy uses fixed-length prefixes (type exactly N chars)
- emacs-flash guarantees labels won't continue your search pattern
- avy has more built-in actions (copy, move, etc.)

CREDITS                                                *emacs-flash-credits*

emacs-flash is inspired by flash.nvim <https://github.com/folke/flash.nvim>
by folke.

Author: chestnykh

LICENSE                                                *emacs-flash-license*

MIT License

==============================================================================
vim:tw=78:ts=8:noet:ft=help:norl:
